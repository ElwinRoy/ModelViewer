<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Sneakers AR Experience</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    
    html, body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #000;
      color: white;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    #cameraBackground {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: 1;
    }

    #introScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
    }

    .intro-ripple {
      position: absolute;
      width: 300px;
      height: 300px;
      border-radius: 50%;
      border: 1px solid rgba(0, 212, 255, 0.3);
      animation: rippleExpand 3s ease-out infinite;
    }

    .intro-ripple:nth-child(2) { animation-delay: 1s; }
    .intro-ripple:nth-child(3) { animation-delay: 2s; }

    @keyframes rippleExpand {
      0% { transform: scale(0.5); opacity: 1; }
      100% { transform: scale(2); opacity: 0; }
    }

    .press-button {
      position: relative;
      width: 180px;
      height: 180px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(0, 255, 157, 0.3), rgba(0, 212, 255, 0.15), rgba(0, 100, 150, 0.2));
      border: 2px solid rgba(0, 212, 255, 0.5);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: bold;
      color: white;
      text-align: center;
      animation: pulseButton 2.5s infinite;
      backdrop-filter: blur(10px);
      z-index: 10;
    }

    @keyframes pulseButton {
      0%, 100% { 
        transform: scale(1); 
        box-shadow: 0 0 40px rgba(0, 212, 255, 0.5), 0 0 80px rgba(0, 255, 157, 0.2);
      }
      50% { 
        transform: scale(1.02); 
        box-shadow: 0 0 60px rgba(0, 212, 255, 0.7), 0 0 100px rgba(0, 255, 157, 0.4);
      }
    }

    .press-button:active { transform: scale(0.95); }

    #videoScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 90;
      display: none;
      align-items: center;
      justify-content: center;
      perspective: 1200px;
      overflow: hidden;
      background: transparent;
    }

    .background-glow {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 300px;
      height: 500px;
      border-radius: 30px;
      background: radial-gradient(ellipse at center, rgba(0, 212, 255, 0.25) 0%, rgba(0, 150, 255, 0.15) 30%, rgba(0, 100, 200, 0.08) 50%, transparent 70%);
      filter: blur(40px);
      animation: bgGlowPulse 3s ease-in-out infinite;
      pointer-events: none;
      z-index: 1;
    }

    .background-glow-secondary {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 350px;
      height: 550px;
      border-radius: 50%;
      background: radial-gradient(ellipse at center, rgba(255, 0, 128, 0.12) 0%, rgba(128, 0, 255, 0.08) 30%, transparent 60%);
      filter: blur(50px);
      animation: bgGlowPulse 4s ease-in-out infinite reverse;
      pointer-events: none;
      z-index: 1;
    }

    .background-glow-tertiary {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
      height: 600px;
      border-radius: 50%;
      background: radial-gradient(ellipse at center, rgba(0, 255, 136, 0.1) 0%, transparent 50%);
      filter: blur(60px);
      animation: bgGlowPulse 5s ease-in-out infinite;
      pointer-events: none;
      z-index: 1;
    }

    @keyframes bgGlowPulse {
      0%, 100% { opacity: 0.6; transform: translate(-50%, -50%) scale(1); }
      50% { opacity: 1; transform: translate(-50%, -50%) scale(1.15); }
    }

    .floating-orb {
      position: fixed;
      border-radius: 50%;
      pointer-events: none;
      z-index: 2;
    }

    .orb-1 {
      width: 80px;
      height: 80px;
      top: 15%;
      left: 10%;
      background: radial-gradient(circle at 30% 30%, rgba(0, 212, 255, 0.4), rgba(0, 150, 255, 0.1), transparent);
      animation: floatOrb1 8s ease-in-out infinite;
      filter: blur(2px);
    }

    .orb-2 {
      width: 60px;
      height: 60px;
      top: 20%;
      right: 15%;
      background: radial-gradient(circle at 30% 30%, rgba(255, 0, 128, 0.3), rgba(200, 0, 100, 0.1), transparent);
      animation: floatOrb2 10s ease-in-out infinite;
      filter: blur(2px);
    }

    .orb-3 {
      width: 100px;
      height: 100px;
      bottom: 20%;
      left: 5%;
      background: radial-gradient(circle at 30% 30%, rgba(0, 255, 136, 0.3), rgba(0, 200, 100, 0.1), transparent);
      animation: floatOrb3 12s ease-in-out infinite;
      filter: blur(3px);
    }

    .orb-4 {
      width: 50px;
      height: 50px;
      bottom: 25%;
      right: 10%;
      background: radial-gradient(circle at 30% 30%, rgba(255, 200, 0, 0.35), rgba(255, 150, 0, 0.1), transparent);
      animation: floatOrb4 9s ease-in-out infinite;
      filter: blur(2px);
    }

    @keyframes floatOrb1 {
      0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.6; }
      25% { transform: translate(30px, -40px) scale(1.1); opacity: 0.8; }
      50% { transform: translate(-20px, -60px) scale(0.9); opacity: 1; }
      75% { transform: translate(20px, -30px) scale(1.05); opacity: 0.7; }
    }

    @keyframes floatOrb2 {
      0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.5; }
      33% { transform: translate(-40px, 30px) scale(1.15); opacity: 0.8; }
      66% { transform: translate(20px, -40px) scale(0.95); opacity: 0.6; }
    }

    @keyframes floatOrb3 {
      0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.5; }
      50% { transform: translate(50px, -50px) scale(1.2); opacity: 0.9; }
    }

    @keyframes floatOrb4 {
      0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.6; }
      25% { transform: translate(-30px, -20px) scale(1.1); opacity: 0.9; }
      75% { transform: translate(25px, 30px) scale(0.9); opacity: 0.5; }
    }

    .sparkle {
      position: fixed;
      width: 4px;
      height: 4px;
      background: white;
      border-radius: 50%;
      pointer-events: none;
      z-index: 3;
      box-shadow: 0 0 6px 2px rgba(255, 255, 255, 0.8);
      animation: sparkle 2.5s ease-in-out infinite;
    }

    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }

    .light-streak {
      position: fixed;
      width: 2px;
      height: 100px;
      background: linear-gradient(to bottom, transparent, rgba(0, 212, 255, 0.6), transparent);
      pointer-events: none;
      z-index: 2;
      animation: streakFall 4s linear infinite;
      opacity: 0;
    }

    @keyframes streakFall {
      0% { transform: translateY(-100px) rotate(15deg); opacity: 0; }
      10% { opacity: 0.7; }
      90% { opacity: 0.7; }
      100% { transform: translateY(100vh) rotate(15deg); opacity: 0; }
    }

    .particles-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
      z-index: 2;
    }

    .particle {
      position: absolute;
      background: radial-gradient(circle, rgba(0, 212, 255, 0.8), transparent);
      border-radius: 50%;
      animation: floatParticle linear infinite;
    }

    .particle-glow {
      position: absolute;
      border-radius: 50%;
      animation: floatParticleGlow linear infinite;
      filter: blur(1px);
    }

    @keyframes floatParticle {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-100px) rotate(720deg); opacity: 0; }
    }

    @keyframes floatParticleGlow {
      0% { transform: translateY(100vh) scale(1); opacity: 0; }
      10% { opacity: 0.8; }
      50% { transform: translateY(50vh) scale(1.3); opacity: 1; }
      90% { opacity: 0.8; }
      100% { transform: translateY(-100px) scale(1); opacity: 0; }
    }

    .sound-waves {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      align-items: flex-end;
      gap: 4px;
      height: 35px;
      z-index: 96;
    }

    .wave-bar {
      width: 3px;
      background: linear-gradient(to top, #00d4ff, #00ff88, #fff);
      border-radius: 3px;
      animation: waveAnimation 0.5s ease-in-out infinite alternate;
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.8), 0 0 20px rgba(0, 255, 136, 0.4);
    }

    @keyframes waveAnimation {
      0% { height: 5px; }
      100% { height: 28px; }
    }

    .rotating-ring {
      position: fixed;
      top: 50%;
      left: 50%;
      border: 1px solid transparent;
      border-radius: 50%;
      pointer-events: none;
      z-index: 2;
    }

    .ring-1 {
      width: 280px;
      height: 450px;
      margin-left: -140px;
      margin-top: -225px;
      border-top-color: rgba(0, 212, 255, 0.3);
      border-right-color: rgba(0, 255, 136, 0.2);
      animation: rotateRing1 15s linear infinite;
    }

    .ring-2 {
      width: 320px;
      height: 490px;
      margin-left: -160px;
      margin-top: -245px;
      border-bottom-color: rgba(255, 0, 128, 0.2);
      border-left-color: rgba(128, 0, 255, 0.15);
      animation: rotateRing2 20s linear infinite reverse;
    }

    @keyframes rotateRing1 { to { transform: rotate(360deg); } }
    @keyframes rotateRing2 { to { transform: rotate(-360deg); } }

    .spatial-container {
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.1s ease-out;
      will-change: transform;
      z-index: 10;
    }

    .spatial-frame {
      position: relative;
      width: 220px;
      height: 390px;
      transform-style: preserve-3d;
    }

    .depth-layer-back {
      position: absolute;
      top: 8px;
      left: 8px;
      width: 204px;
      height: 374px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 12px;
      transform: translateZ(-60px);
    }

    .depth-layer-mid {
      position: absolute;
      top: 4px;
      left: 4px;
      width: 212px;
      height: 382px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 14px;
      transform: translateZ(-30px);
    }

    .video-spatial-container {
      position: relative;
      width: 220px;
      height: 390px;
      transform-style: preserve-3d;
      transform: translateZ(0px);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 30px rgba(0, 212, 255, 0.15);
      animation: videoFloat 6s ease-in-out infinite;
    }

    @keyframes videoFloat {
      0%, 100% { transform: translateZ(0px) translateY(0); }
      50% { transform: translateZ(8px) translateY(-4px); }
    }

    .video-spatial-container::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, rgba(0, 212, 255, 0.5), rgba(0, 255, 136, 0.3), rgba(255, 0, 128, 0.3), rgba(128, 0, 255, 0.3), rgba(0, 212, 255, 0.5));
      background-size: 400% 400%;
      border-radius: 17px;
      z-index: -1;
      animation: borderGradient 8s ease infinite;
      opacity: 0.6;
    }

    @keyframes borderGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .corner-accent {
      position: absolute;
      width: 20px;
      height: 20px;
      pointer-events: none;
      z-index: 5;
    }

    .corner-accent::before, .corner-accent::after {
      content: '';
      position: absolute;
      background: rgba(0, 212, 255, 0.6);
    }

    .corner-tl { top: 5px; left: 5px; }
    .corner-tl::before { width: 15px; height: 2px; top: 0; left: 0; }
    .corner-tl::after { width: 2px; height: 15px; top: 0; left: 0; }

    .corner-tr { top: 5px; right: 5px; }
    .corner-tr::before { width: 15px; height: 2px; top: 0; right: 0; }
    .corner-tr::after { width: 2px; height: 15px; top: 0; right: 0; }

    .corner-bl { bottom: 5px; left: 5px; }
    .corner-bl::before { width: 15px; height: 2px; bottom: 0; left: 0; }
    .corner-bl::after { width: 2px; height: 15px; bottom: 0; left: 0; }

    .corner-br { bottom: 5px; right: 5px; }
    .corner-br::before { width: 15px; height: 2px; bottom: 0; right: 0; }
    .corner-br::after { width: 2px; height: 15px; bottom: 0; right: 0; }

    #videoPlayer {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      border-radius: 15px;
    }

    #videoPlayer::-webkit-media-controls { display: none !important; }

    .visualize-button {
      position: absolute;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 22px;
      font-size: 10px;
      font-weight: 600;
      border-radius: 25px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
      color: white;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      z-index: 10;
      opacity: 0;
      visibility: hidden;
      transition: all 0.5s ease;
      overflow: hidden;
    }

    .visualize-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      animation: btnShine 2s infinite;
    }

    @keyframes btnShine {
      0% { left: -100%; }
      50%, 100% { left: 100%; }
    }

    .visualize-button.visible {
      opacity: 1;
      visibility: visible;
      animation: buttonPop 0.5s ease-out;
    }

    @keyframes buttonPop {
      0% { transform: translateX(-50%) scale(0.5); opacity: 0; }
      60% { transform: translateX(-50%) scale(1.1); }
      100% { transform: translateX(-50%) scale(1); opacity: 1; }
    }

    .visualize-button:active { 
      transform: translateX(-50%) scale(0.95);
      background: rgba(255, 255, 255, 0.1);
    }

    .floor-shadow {
      position: absolute;
      bottom: -60px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 100px;
      background: radial-gradient(ellipse at center, rgba(0, 150, 255, 0.2) 0%, rgba(0, 0, 0, 0.3) 40%, transparent 70%);
      filter: blur(20px);
      animation: shadowPulse 3s ease-in-out infinite;
    }

    @keyframes shadowPulse {
      0%, 100% { opacity: 0.6; transform: translateX(-50%) scale(1); }
      50% { opacity: 0.9; transform: translateX(-50%) scale(1.1); }
    }

    .gyro-hint {
      position: fixed;
      bottom: 130px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 11px;
      color: rgba(255, 255, 255, 0.8);
      text-align: center;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
      background: rgba(0, 0, 0, 0.5);
      padding: 8px 18px;
      border-radius: 25px;
      backdrop-filter: blur(10px);
      transition: opacity 0.5s ease;
      z-index: 95;
      border: 1px solid rgba(255, 255, 255, 0.1);
      animation: hintPulse 2s ease-in-out infinite;
    }

    @keyframes hintPulse {
      0%, 100% { box-shadow: 0 0 10px rgba(0, 212, 255, 0.2); }
      50% { box-shadow: 0 0 20px rgba(0, 212, 255, 0.4); }
    }

    #modelsScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 80;
      display: none;
      flex-direction: column;
      overflow: hidden;
      background: transparent;
    }

    .models-scroll-container {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
      padding: 20px 12px;
      padding-bottom: 100px;
    }

    .models-header {
      text-align: center;
      margin-bottom: 20px;
      padding: 20px 15px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      border-radius: 15px;
    }

    .models-header h2 {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .models-header p {
      font-size: 12px;
      opacity: 0.7;
    }

    .shoes-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 15px;
      max-width: 400px;
      margin: 0 auto;
      padding-bottom: 20px;
    }

    .shoe-card {
      background: transparent;
      border-radius: 20px;
      overflow: visible;
      border: none;
    }

    .model-wrap { 
      height: 220px; 
      background: transparent !important;
      touch-action: pan-y;
      position: relative;
    }
    
    .model-wrap model-viewer { 
      width: 100%; 
      height: 100%; 
      background-color: transparent !important;
      --poster-color: transparent;
      --progress-bar-color: transparent;
      touch-action: pan-y;
    }

    .info { 
      padding: 18px 15px; 
      text-align: center;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      margin-top: 10px;
    }
    
    .info h3 { 
      font-size: 18px; 
      margin-bottom: 5px; 
      font-weight: 600;
    }
    
    .info .price { 
      opacity: 0.7; 
      font-size: 15px; 
      margin-bottom: 15px;
    }

    .btn-3d-home {
      background: #fff;
      color: #000;
      border: none;
      padding: 14px 20px;
      border-radius: 30px;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin: 0 auto;
      width: 100%;
    }
    
    .btn-3d-home:active { 
      transform: scale(0.97);
      background: #eee;
    }

    .back-to-video-btn {
      position: fixed;
      bottom: 25px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      padding: 12px 30px;
      border-radius: 25px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      z-index: 86;
      backdrop-filter: blur(10px);
    }

    .back-to-video-btn:active {
      transform: translateX(-50%) scale(0.95);
    }

    #arDetailView { 
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100vw; 
      height: 100vh; 
      display: none; 
      z-index: 110;
      background: transparent;
    }

    #ar3DModel {
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100vw; 
      height: 100vh; 
      z-index: 111;
      --poster-color: transparent;
      background-color: transparent !important;
    }

    .top-bar {
      position: fixed;
      top: 20px;
      left: 15px;
      right: 15px;
      display: flex;
      justify-content: space-between;
      z-index: 115;
    }

    .model-name-badge {
      background: rgba(0, 0, 0, 0.6);
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
      backdrop-filter: blur(10px);
    }

    .color-badge {
      background: rgba(0, 0, 0, 0.6);
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 11px;
      display: flex;
      align-items: center;
      gap: 8px;
      backdrop-filter: blur(10px);
    }

    .color-dot {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .color-row {
      position: fixed;
      top: 70px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      z-index: 115;
      max-width: 340px;
    }

    .color-chip {
      padding: 8px 14px;
      border-radius: 20px;
      border: 2px solid transparent;
      font-size: 10px;
      font-weight: 600;
      cursor: pointer;
      backdrop-filter: blur(5px);
    }

    .color-chip.selected {
      border-color: #00d4ff;
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
    }

    .color-chip:active { transform: scale(0.95); }

    .zoom-btns {
      position: fixed;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 115;
    }

    .zoom-btn {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(10px);
    }

    .zoom-btn:active { background: rgba(255, 255, 255, 0.2); }

    .bottom-bar {
      position: fixed;
      bottom: 25px;
      left: 15px;
      right: 15px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      z-index: 115;
    }

    .order-btn {
      background: linear-gradient(135deg, #ff6b35, #f7931e);
      color: white;
      border: none;
      padding: 14px 40px;
      border-radius: 30px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
      max-width: 280px;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 20px rgba(255, 107, 53, 0.4);
    }

    .order-btn:active { transform: scale(0.97); }

    .action-row {
      display: flex;
      gap: 10px;
    }

    .action-btn {
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      padding: 10px 18px;
      border-radius: 20px;
      font-size: 11px;
      cursor: pointer;
      backdrop-filter: blur(10px);
    }

    .action-btn:active { background: rgba(255, 255, 255, 0.1); }

    .loading-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
      flex-direction: column;
      gap: 15px;
    }

    .loading-overlay.active { display: flex; }

    .loader {
      width: 40px; height: 40px;
      border: 3px solid rgba(255, 255, 255, 0.2);
      border-top-color: #00d4ff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>

  <video id="cameraBackground" autoplay playsinline muted></video>

  <div class="loading-overlay" id="loadingOverlay">
    <div class="loader"></div>
    <div>Loading...</div>
  </div>

  <div id="introScreen">
    <div class="intro-ripple"></div>
    <div class="intro-ripple"></div>
    <div class="intro-ripple"></div>
    <button class="press-button" id="startBtn">TAP TO<br>START</button>
  </div>

  <div id="videoScreen">
    <div class="background-glow"></div>
    <div class="background-glow-secondary"></div>
    <div class="background-glow-tertiary"></div>
    
    <div class="floating-orb orb-1"></div>
    <div class="floating-orb orb-2"></div>
    <div class="floating-orb orb-3"></div>
    <div class="floating-orb orb-4"></div>
    
    <div class="sparkle" style="top: 12%; left: 8%; animation-delay: 0s;"></div>
    <div class="sparkle" style="top: 18%; right: 12%; animation-delay: 0.5s;"></div>
    <div class="sparkle" style="top: 35%; left: 5%; animation-delay: 1s;"></div>
    <div class="sparkle" style="top: 45%; right: 8%; animation-delay: 1.5s;"></div>
    <div class="sparkle" style="bottom: 35%; left: 10%; animation-delay: 0.3s;"></div>
    <div class="sparkle" style="bottom: 25%; right: 15%; animation-delay: 0.8s;"></div>
    <div class="sparkle" style="bottom: 45%; left: 15%; animation-delay: 1.2s;"></div>
    <div class="sparkle" style="top: 60%; right: 5%; animation-delay: 1.8s;"></div>
    
    <div class="light-streak" style="left: 10%; animation-delay: 0s;"></div>
    <div class="light-streak" style="left: 25%; animation-delay: 1s;"></div>
    <div class="light-streak" style="left: 75%; animation-delay: 2s;"></div>
    <div class="light-streak" style="left: 90%; animation-delay: 0.5s;"></div>
    <div class="light-streak" style="left: 50%; animation-delay: 1.5s;"></div>
    
    <div class="rotating-ring ring-1"></div>
    <div class="rotating-ring ring-2"></div>
    
    <div class="particles-container" id="particlesContainer"></div>

    <div class="sound-waves" id="soundWaves">
      <div class="wave-bar" style="animation-delay: 0s;"></div>
      <div class="wave-bar" style="animation-delay: 0.1s;"></div>
      <div class="wave-bar" style="animation-delay: 0.2s;"></div>
      <div class="wave-bar" style="animation-delay: 0.3s;"></div>
      <div class="wave-bar" style="animation-delay: 0.4s;"></div>
      <div class="wave-bar" style="animation-delay: 0.35s;"></div>
      <div class="wave-bar" style="animation-delay: 0.25s;"></div>
      <div class="wave-bar" style="animation-delay: 0.15s;"></div>
      <div class="wave-bar" style="animation-delay: 0.05s;"></div>
    </div>

    <div class="gyro-hint" id="gyroHint">üì± Tilt or drag to explore depth</div>

    <div class="spatial-container" id="spatialContainer">
      <div class="spatial-frame">
        <div class="depth-layer-back"></div>
        <div class="depth-layer-mid"></div>
        
        <div class="video-spatial-container">
          <div class="corner-accent corner-tl"></div>
          <div class="corner-accent corner-tr"></div>
          <div class="corner-accent corner-bl"></div>
          <div class="corner-accent corner-br"></div>
          
          <video id="videoPlayer" playsinline loop>
            <source src="https://github.com/ElwinRoy/ModelViewer/raw/main/nike.mp4" type="video/mp4">
          </video>
          <button class="visualize-button" id="visualizeBtn">‚ú® View Models</button>
        </div>
        
        <div class="floor-shadow"></div>
      </div>
    </div>
  </div>

  <div id="modelsScreen">
    <div class="models-scroll-container" id="scrollContainer">
      <div class="models-header">
        <h2>Choose Your Sneaker</h2>
        <p>Select a model to view in AR</p>
      </div>
      <div class="shoes-grid" id="shoesGrid"></div>
    </div>
    <button class="back-to-video-btn" id="backToVideoBtn">‚Üê Back to Video</button>
  </div>

  <div id="arDetailView">
    <model-viewer id="ar3DModel"
      ar ar-modes="webxr scene-viewer quick-look"
      camera-controls touch-action="pan-y"
      shadow-intensity="1" exposure="1.0"
      interaction-prompt="none" environment-image="neutral"
      auto-rotate rotation-per-second="20deg">
    </model-viewer>

    <div class="top-bar">
      <div class="model-name-badge" id="modelName">Sneaker</div>
      <div class="color-badge">
        <div class="color-dot" id="colorDot" style="background:#888;"></div>
        <span id="colorLabel">Original</span>
      </div>
    </div>

    <div class="color-row" id="colorRow"></div>

    <div class="zoom-btns">
      <button class="zoom-btn" id="zoomIn">+</button>
      <button class="zoom-btn" id="zoomOut">‚àí</button>
    </div>

    <div class="bottom-bar">
      <button class="order-btn" id="orderBtn">üõí Order Now</button>
      <div class="action-row">
        <button class="action-btn" id="replayBtn">‚Üª Replay</button>
        <button class="action-btn" id="backBtn">‚Üê Back</button>
      </div>
    </div>
  </div>

  <script>
    const shoes = [
      { name: "New Balance 997", price: "‚Çπ14,999", model: "https://cdn.jsdelivr.net/gh/ElwinRoy/test@main/Shoe%2001%20(1).glb" },
      { name: "Formal Edge", price: "‚Çπ12,999", model: "https://cdn.jsdelivr.net/gh/ElwinRoy/test@main/Shoe%2002%20(1).glb" },
      { name: "ND Runner", price: "‚Çπ16,999", model: "https://cdn.jsdelivr.net/gh/ElwinRoy/test@main/Shoe%2003%20(1).glb" }
    ];

    const colors = [
      { id: 'original', name: 'Original', bg: '#888', text: '#fff', r: 0.53, g: 0.53, b: 0.53 },
      { id: 'black', name: 'Black', bg: '#222', text: '#fff', r: 0.13, g: 0.13, b: 0.13 },
      { id: 'white', name: 'White', bg: '#f5f5f5', text: '#000', r: 0.96, g: 0.96, b: 0.96 },
      { id: 'red', name: 'Red', bg: '#c0392b', text: '#fff', r: 0.75, g: 0.22, b: 0.17 },
      { id: 'blue', name: 'Blue', bg: '#2980b9', text: '#fff', r: 0.16, g: 0.50, b: 0.73 },
      { id: 'green', name: 'Green', bg: '#27ae60', text: '#fff', r: 0.15, g: 0.68, b: 0.38 }
    ];

    const ORDER_URL = "https://www.superkicks.in/?srsltid=AfmBOor9rXpYcBLeJhsC4CYMZvB6CJ-OI5h10Zxmq_ZbkrqnLp4p2dUE";

    const $ = id => document.getElementById(id);
    
    const el = {
      camera: $("cameraBackground"),
      intro: $("introScreen"),
      video: $("videoScreen"),
      models: $("modelsScreen"),
      ar: $("arDetailView"),
      model3d: $("ar3DModel"),
      startBtn: $("startBtn"),
      visualizeBtn: $("visualizeBtn"),
      videoPlayer: $("videoPlayer"),
      shoesGrid: $("shoesGrid"),
      modelName: $("modelName"),
      colorRow: $("colorRow"),
      colorDot: $("colorDot"),
      colorLabel: $("colorLabel"),
      loading: $("loadingOverlay"),
      zoomIn: $("zoomIn"),
      zoomOut: $("zoomOut"),
      orderBtn: $("orderBtn"),
      replayBtn: $("replayBtn"),
      backBtn: $("backBtn"),
      backToVideoBtn: $("backToVideoBtn"),
      scrollContainer: $("scrollContainer"),
      soundWaves: $("soundWaves"),
      particlesContainer: $("particlesContainer"),
      spatialContainer: $("spatialContainer"),
      gyroHint: $("gyroHint")
    };

    let cameraStream = null;
    let currentShoe = null;
    let originalColors = new Map();
    let selectedColor = 'original';
    let buttonTimeout = null;

    let rotateX = 0, rotateY = 0, targetRotateX = 0, targetRotateY = 0;
    let isGyroActive = false, isDragging = false, lastTouchX = 0, lastTouchY = 0;

    function initGyroscope() {
      if (window.DeviceOrientationEvent) {
        if (typeof DeviceOrientationEvent.requestPermission === 'function') {
          document.addEventListener('click', requestGyroPermission, { once: true });
        } else {
          window.addEventListener('deviceorientation', handleOrientation);
          isGyroActive = true;
        }
      }
    }

    async function requestGyroPermission() {
      try {
        const permission = await DeviceOrientationEvent.requestPermission();
        if (permission === 'granted') {
          window.addEventListener('deviceorientation', handleOrientation);
          isGyroActive = true;
        }
      } catch (e) { console.log('Gyroscope not available'); }
    }

    function handleOrientation(event) {
      if (!el.video.style.display || el.video.style.display === 'none') return;
      const beta = event.beta || 0;
      const gamma = event.gamma || 0;
      targetRotateX = Math.max(-12, Math.min(12, (beta - 45) * 0.25));
      targetRotateY = Math.max(-12, Math.min(12, gamma * 0.35));
    }

    function initDragParallax() {
      const container = el.spatialContainer;
      
      container.addEventListener('touchstart', (e) => {
        isDragging = true;
        lastTouchX = e.touches[0].clientX;
        lastTouchY = e.touches[0].clientY;
        el.gyroHint.style.opacity = '0';
      });

      container.addEventListener('touchmove', (e) => {
        if (!isDragging) return;
        const touchX = e.touches[0].clientX;
        const touchY = e.touches[0].clientY;
        targetRotateY += (touchX - lastTouchX) * 0.12;
        targetRotateX -= (touchY - lastTouchY) * 0.12;
        targetRotateX = Math.max(-15, Math.min(15, targetRotateX));
        targetRotateY = Math.max(-20, Math.min(20, targetRotateY));
        lastTouchX = touchX;
        lastTouchY = touchY;
      });

      container.addEventListener('touchend', () => {
        isDragging = false;
        if (!isGyroActive) {
          setTimeout(() => { if (!isDragging) { targetRotateX *= 0.5; targetRotateY *= 0.5; } }, 1500);
        }
      });

      container.addEventListener('mousedown', (e) => { isDragging = true; lastTouchX = e.clientX; lastTouchY = e.clientY; });
      window.addEventListener('mousemove', (e) => {
        if (!isDragging) return;
        targetRotateY += (e.clientX - lastTouchX) * 0.08;
        targetRotateX -= (e.clientY - lastTouchY) * 0.08;
        targetRotateX = Math.max(-15, Math.min(15, targetRotateX));
        targetRotateY = Math.max(-20, Math.min(20, targetRotateY));
        lastTouchX = e.clientX;
        lastTouchY = e.clientY;
      });
      window.addEventListener('mouseup', () => { isDragging = false; });
    }

    function animateParallax() {
      rotateX += (targetRotateX - rotateX) * 0.1;
      rotateY += (targetRotateY - rotateY) * 0.1;
      if (el.spatialContainer) {
        el.spatialContainer.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
      }
      requestAnimationFrame(animateParallax);
    }

    initGyroscope();
    initDragParallax();
    animateParallax();

    function createParticles() {
      const container = el.particlesContainer;
      container.innerHTML = '';
      
      for (let i = 0; i < 15; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        const size = Math.random() * 5 + 2;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDuration = (Math.random() * 8 + 10) + 's';
        particle.style.animationDelay = (Math.random() * 8) + 's';
        container.appendChild(particle);
      }

      const glowColors = ['rgba(0, 212, 255, 0.6)', 'rgba(0, 255, 136, 0.5)', 'rgba(255, 0, 128, 0.4)', 'rgba(255, 200, 0, 0.5)'];
      for (let i = 0; i < 8; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle-glow';
        const size = Math.random() * 8 + 4;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.background = `radial-gradient(circle, ${glowColors[Math.floor(Math.random() * glowColors.length)]}, transparent)`;
        particle.style.animationDuration = (Math.random() * 10 + 12) + 's';
        particle.style.animationDelay = (Math.random() * 10) + 's';
        container.appendChild(particle);
      }
    }

    const Haptic = {
      supported: 'vibrate' in navigator,
      intervalId: null,
      stop() {
        if (this.supported) navigator.vibrate(0);
        if (this.intervalId) { clearInterval(this.intervalId); this.intervalId = null; }
      },
      tap(ms = 50) { if (this.supported) navigator.vibrate(ms); },
      startup() { this.stop(); if (this.supported) navigator.vibrate([100, 50, 100, 50, 200]); },
      videoStart() {
        this.stop();
        if (!this.supported) return;
        const pulse = () => navigator.vibrate([40, 80, 40, 80, 40, 80]);
        pulse();
        this.intervalId = setInterval(pulse, 800);
      },
      success() { if (this.supported) navigator.vibrate([30, 30, 30, 30, 60]); }
    };

    async function initCamera() {
      const opts = [
        { video: { facingMode: { exact: "environment" } } },
        { video: { facingMode: "environment" } },
        { video: true }
      ];
      for (const opt of opts) {
        try {
          cameraStream = await navigator.mediaDevices.getUserMedia(opt);
          el.camera.srcObject = cameraStream;
          await el.camera.play();
          return;
        } catch (e) { continue; }
      }
      document.body.style.background = "#1a1a2e";
    }
    initCamera();

    function showViewModelsButton() {
      el.visualizeBtn.classList.add('visible');
      Haptic.success();
    }

    el.startBtn.onclick = async () => {
      Haptic.startup();
      el.intro.style.display = "none";
      el.video.style.display = "flex";
      el.visualizeBtn.classList.remove('visible');
      targetRotateX = 0;
      targetRotateY = 0;
      el.gyroHint.style.opacity = '1';
      createParticles();
      el.videoPlayer.muted = false;
      if (buttonTimeout) { clearTimeout(buttonTimeout); buttonTimeout = null; }

      try {
        await el.videoPlayer.play();
        setTimeout(() => Haptic.videoStart(), 2000);
        setTimeout(() => { el.gyroHint.style.opacity = '0'; }, 4000);
        buttonTimeout = setTimeout(showViewModelsButton, 10000);
      } catch (e) {
        el.videoPlayer.muted = true;
        try {
          await el.videoPlayer.play();
          setTimeout(() => { el.videoPlayer.muted = false; }, 100);
          setTimeout(() => Haptic.videoStart(), 2000);
          buttonTimeout = setTimeout(showViewModelsButton, 10000);
        } catch (e2) {
          Haptic.stop();
          el.video.style.display = "none";
          el.models.style.display = "flex";
        }
      }
    };

    el.videoPlayer.addEventListener('error', () => {
      Haptic.stop();
      if (buttonTimeout) { clearTimeout(buttonTimeout); buttonTimeout = null; }
      el.video.style.display = "none";
      el.models.style.display = "flex";
    });

    el.videoPlayer.addEventListener('pause', () => Haptic.stop());
    el.videoPlayer.addEventListener('play', () => { if (!Haptic.intervalId) Haptic.videoStart(); });

    el.visualizeBtn.onclick = () => {
      Haptic.stop();
      Haptic.tap(30);
      if (buttonTimeout) { clearTimeout(buttonTimeout); buttonTimeout = null; }
      el.videoPlayer.pause();
      el.visualizeBtn.classList.remove('visible');
      el.video.style.display = "none";
      el.models.style.display = "flex";
      el.scrollContainer.scrollTop = 0;
    };

    el.backToVideoBtn.onclick = () => {
      Haptic.tap(30);
      el.models.style.display = "none";
      el.video.style.display = "flex";
      el.visualizeBtn.classList.remove('visible');
      el.videoPlayer.currentTime = 0;
      el.videoPlayer.muted = false;
      targetRotateX = 0;
      targetRotateY = 0;
      el.gyroHint.style.opacity = '1';
      createParticles();
      el.videoPlayer.play();
      setTimeout(() => { el.gyroHint.style.opacity = '0'; }, 4000);
      if (buttonTimeout) clearTimeout(buttonTimeout);
      buttonTimeout = setTimeout(showViewModelsButton, 10000);
    };

    shoes.forEach((shoe, i) => {
      const card = document.createElement("div");
      card.className = "shoe-card";
      card.innerHTML = `
        <div class="model-wrap">
          <model-viewer src="${shoe.model}" auto-rotate rotation-per-second="25deg"
            interaction-prompt="none" shadow-intensity="0" exposure="1.0"
            camera-orbit="0deg 75deg auto" field-of-view="auto" loading="eager"
            touch-action="pan-y" style="background-color: transparent;">
          </model-viewer>
        </div>
        <div class="info">
          <h3>${shoe.name}</h3>
          <div class="price">${shoe.price}</div>
          <button class="btn-3d-home" data-i="${i}">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9H15V22H13V16H11V22H9V9H3V7H21V9Z"/>
            </svg>
            View in AR
          </button>
        </div>
      `;
      el.shoesGrid.appendChild(card);
    });

    document.querySelectorAll('.btn-3d-home').forEach(btn => {
      btn.onclick = (e) => {
        e.stopPropagation();
        Haptic.tap(30);
        const i = parseInt(btn.dataset.i);
        currentShoe = shoes[i];
        el.modelName.textContent = currentShoe.name;
        el.loading.classList.add('active');
        el.models.style.display = "none";
        el.ar.style.display = "block";
        selectedColor = 'original';
        renderColors();
        updateColorBadge('original');
        el.model3d.setAttribute('camera-orbit', '0deg 75deg auto');
        el.model3d.src = currentShoe.model;
        el.model3d.addEventListener('load', () => {
          storeOriginal();
          Haptic.success();
          setTimeout(() => el.loading.classList.remove('active'), 400);
        }, { once: true });
      };
    });

    function storeOriginal() {
      originalColors.clear();
      const m = el.model3d.model;
      if (m) {
        for (const mat of m.materials) {
          const pbr = mat.pbrMetallicRoughness;
          if (pbr?.baseColorFactor) originalColors.set(mat.name, [...pbr.baseColorFactor]);
        }
      }
    }

    function resetColor() {
      const m = el.model3d.model;
      if (m && originalColors.size) {
        for (const mat of m.materials) {
          const o = originalColors.get(mat.name);
          if (o) mat.pbrMetallicRoughness.setBaseColorFactor(o);
        }
      }
    }

    function applyColor(id) {
      if (id === 'original') { resetColor(); return; }
      const c = colors.find(x => x.id === id);
      if (!c) return;
      const m = el.model3d.model;
      if (!m) return;
      for (const mat of m.materials) {
        const pbr = mat.pbrMetallicRoughness;
        if (pbr) {
          const a = pbr.baseColorFactor?.[3] || 1;
          pbr.setBaseColorFactor([c.r, c.g, c.b, a]);
        }
      }
    }

    function selectColorChip(id) {
      Haptic.tap(20);
      selectedColor = id;
      renderColors();
      updateColorBadge(id);
      applyColor(id);
    }

    function renderColors() {
      el.colorRow.innerHTML = '';
      colors.forEach(c => {
        const chip = document.createElement('button');
        chip.className = `color-chip ${c.id === selectedColor ? 'selected' : ''}`;
        chip.style.background = c.bg;
        chip.style.color = c.text;
        chip.textContent = c.name;
        chip.onclick = () => selectColorChip(c.id);
        el.colorRow.appendChild(chip);
      });
    }

    function updateColorBadge(id) {
      const c = colors.find(x => x.id === id);
      if (c) {
        el.colorDot.style.background = c.bg;
        el.colorLabel.textContent = c.name;
      }
    }

    let fov = 45;
    el.zoomIn.onclick = () => { Haptic.tap(20); fov = Math.max(15, fov - 5); el.model3d.setAttribute('field-of-view', fov + 'deg'); };
    el.zoomOut.onclick = () => { Haptic.tap(20); fov = Math.min(80, fov + 5); el.model3d.setAttribute('field-of-view', fov + 'deg'); };

    el.orderBtn.onclick = () => {
      Haptic.success();
      window.open(ORDER_URL, '_blank');
    };

    el.replayBtn.onclick = () => {
      Haptic.tap(30);
      el.ar.style.display = "none";
      el.video.style.display = "flex";
      el.visualizeBtn.classList.remove('visible');
      el.videoPlayer.currentTime = 0;
      el.videoPlayer.muted = false;
      targetRotateX = 0;
      targetRotateY = 0;
      el.gyroHint.style.opacity = '1';
      createParticles();
      el.videoPlayer.play();
      setTimeout(() => { el.gyroHint.style.opacity = '0'; }, 4000);
      if (buttonTimeout) clearTimeout(buttonTimeout);
      buttonTimeout = setTimeout(showViewModelsButton, 10000);
    };

    el.backBtn.onclick = () => {
      Haptic.tap(30);
      el.ar.style.display = "none";
      el.models.style.display = "flex";
    };

    el.model3d.addEventListener('error', () => el.loading.classList.remove('active'));

    window.addEventListener('beforeunload', () => {
      Haptic.stop();
      if (buttonTimeout) { clearTimeout(buttonTimeout); buttonTimeout = null; }
      if (cameraStream) cameraStream.getTracks().forEach(t => t.stop());
    });

    document.addEventListener('visibilitychange', async () => {
      if (document.hidden) {
        Haptic.stop();
        if (cameraStream) cameraStream.getTracks().forEach(t => t.stop());
      } else {
        await initCamera();
      }
    });
  </script>
</body>
</html>
